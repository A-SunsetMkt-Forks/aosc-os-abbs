PKGNAME=phoc
PKGSEC=libs
PKGDES="Wayland compositor for Phosh"
PKGDEP="glib libinput wayland mesa systemd x11-lib gnome-desktop pixman \
        libxcb xwayland wlroots"
BUILDDEP="gi-docgen gtk-doc"

# FIXME: gtk-doc generation broken as of 0.20.0.
#    ...
#
# [284/285] Generating src/Phoc-0.typelib with a custom command
# FAILED: src/Phoc-0.typelib 
# / usr/bin/g-ir-compiler src/Phoc-0.gir --output src/Phoc-0.typelib --includedir=/usr/share/gir-1.0
# **
# ERROR:../girepository/girparser.c:343:state_switch: assertion failed: (ctx->state != newstate)
# Bail out! ERROR:../girepository/girparser.c:343:state_switch: assertion failed: (ctx->state != newstate)
#
# Upstream has no interest in fixing it.
#
# Ref: https://gitlab.gnome.org/World/Phosh/phoc/-/commit/ed70105fece1ce63d8371a89d6b1dda0bce9f6d5.
MESON_AFTER="-Dxwayland=enabled \
             -Dembed-wlroots=disabled \
             -Dgtk_doc=false"
