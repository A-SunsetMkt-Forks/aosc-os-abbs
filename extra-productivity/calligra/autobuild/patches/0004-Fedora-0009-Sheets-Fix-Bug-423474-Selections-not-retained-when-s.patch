From 4788317516dd7d63235819b2f8ee5503221d0abf Mon Sep 17 00:00:00 2001
From: Dag Andersen <dag.andersen@kdemail.net>
Date: Thu, 25 Jun 2020 10:09:29 +0200
Subject: [PATCH 09/54] Sheets: Fix Bug 423474 - Selections not retained when
 switching between sheets

BUG: 423474
---
 sheets/part/View.cpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/sheets/part/View.cpp b/sheets/part/View.cpp
index 02e43b81b48..8c3d76af78a 100644
--- a/sheets/part/View.cpp
+++ b/sheets/part/View.cpp
@@ -1266,7 +1266,8 @@ void View::setActiveSheet(Sheet* sheet, bool updateSheet)
     d->selection->clear();
     d->selection->setActiveSheet(d->activeSheet);
     d->selection->setOriginSheet(d->activeSheet);
-    d->selection->initialize(QRect(newMarker, newAnchor));
+    d->selection->initialize(newAnchor);
+    d->selection->update(newMarker);
 
     d->actions->showPageOutline->blockSignals(true);
     d->actions->showPageOutline->setChecked(d->activeSheet->isShowPageOutline());
-- 
2.31.1

