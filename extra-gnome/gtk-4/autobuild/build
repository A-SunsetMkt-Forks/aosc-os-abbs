(
abinfo "Configuring $PKGNAME ..."
mkdir "$SRCDIR"/build
cd "$SRCDIR"/build
meson "$SRCDIR" \
    ${MESON_DEF} ${MESON_AFTER}
)

abinfo "Arch Linux: Building GTK runtime ..."
meson compile \
    -C "$SRCDIR"/build

if [[ "${CROSS:-$ARCH}" = "amd64" ]]; then
    abinfo "Arch Linux: Building documentations ..."
    abwarn "FIXME: Default Ninja target broken, this is a workaround !!"
    ninja -C build \
        g{d,s,t}k4-doc
fi

abinfo "Installing $PKGNAME ..."
DESTDIR="$PKGDIR" \
    meson install -C "$SRCDIR"/build

abinfo "Arch Linux: Creating symlinks for gtk4-update-icon-cache ..."
ln -sv gtk4-update-icon-cache \
    "$PKGDIR"/usr/bin/gtk-update-icon-cache
ln -sv gtk4-update-icon-cache.1 \
    "$PKGDIR"/usr/share/man/man1/gtk-update-icon-cache.1
